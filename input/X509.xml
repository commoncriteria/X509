<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="..\transformspp2html.xsl"?>
<?xml-model href="https://raw.githubusercontent.com/commoncriteria/transforms/master/schemas/CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<Package name="X.509" xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:sec="https://niap-ccevs.org/cc/v1/section">
  <PPReference>
    <ReferenceTable>
      <PPTitle>Functional Package for X.509</PPTitle>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2024-10-21</PPPubDate>
      <Keywords>X.509; certificates; PKI</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2024-10-21</date>
      <subject>Initial version.</subject>
    </entry>
  </RevisionHistory>
  <pp-preferences>
    <!--          <pp-pref name="display-audit-with-sfrs">0</pp-pref>   -->
    <audit-events-in-sfrs/>
  </pp-preferences>
  <sec:Introduction>
    <sec:Overview title="Overview">
      <h:p>X.509 is an International Telecommunication Union Telecommunication Standardization Sector (ITU-T) standard for public key certificates.
        	Public key certificates are used as authentication mechanisms for trusted communications protocols and as integrity verification methods.</h:p>
      <h:p>
        This
        <h:i>Functional Package (FP) for X.509</h:i>
        provides a collection of X.509 
      		Security Functional Requirements (SFRs) and 
      		Evaluation Activities (EAs) for the verification and assertion identities of X.509 certificates, for the limited issuance of certificates used locally by TOE functions, and for the generation and provision of certificate status information of such TOE-issued certificates to the TOE functions that rely on such TOE-issued certificates. The intent 
		of this FP is to provide Protection Profile (PP), collaborative Protection Profile (cPP), and Protection Profile Module (PP-Module) authors 
		with a readily consumable collection of SFRs and EAs to be integrated into
		their documents.
      </h:p>
    </sec:Overview>
    <tech-terms>
      <suppress>Extended Package, TSF Interface</suppress>
      <term full="Authority Key Identifier">A certificate extension that provides a means of identifying the public key corresponding to the private key used to sign a certificate or CRL.</term>
      <term full="basicConstraints">A Boolean flag that is used to designate whether a certificate is a CA certificate. If this flag is present
   	and set to TRUE on a certificate, that certificate also has a pathLen attribute.</term>
      <term full="Certification Authority" abbr="CA">An entity that is responsible for the issuance and maintenance of digital certificates.</term>
      <term full="Certificate Revocation List" abbr="CRL">A method by which a CA has the ability to communicate that a certificate it issued
   	has been revoked and should no longer be trusted, originally described in RFC 5280.</term>
      <term full="Certificate Signing Request" abbr="CSR">A message that a subject sends to a certification authority to apply for a digital certificate.</term>
      <term full="Distinguished Name" abbr="DN">A unique identifier for a subject.</term>
      <term full="extendedKeyUsage" abbr="EKU">An optional attribute of an X.509 certificate that designates the intended usage of the certificate,
   	such as for server authentication, client authentication, or code signing.</term>
      <term full="Enrollment over Secure Transport" abbr="EST">A method of certificate management that uses HTTPS to transmit certificate requests and responses.</term>
      <term full="Online Certificate Status Protocol" abbr="OCSP">A method by which a CA has the ability to communicate that a certificate it issued
   		has been revoked and should no longer be trusted, originally described in RFC 6960.</term>
      <term full="OCSP Stapling">An expedited version of OCSP where the CA includes an assertion of a leaf certificate's validity as 
   		part of a connection handshake.</term>
      <term full="OCSP Multi-Stapling">An expedited version of OCSP where the CA includes an assertion of a leaf certificate's validity, 
   		as well as the validity of any intermediate CA certificates between the root and the leaf, as part of a connection handshake.</term>
      <term full="Object Identifier" abbr="OID">A numeric string that uniquely represents object types in certificates.</term>
      <term full="pathLen">An attribute of CA certificates that specifies the maximum length of a certificate chain that terminates with that certificate.</term>
      <term full="Public Key Infrastructure" abbr="PKI">The practice of associating subjects with public keys for the purpose of trusted communications, and the physical, logical, and personnel mechanisms used in support of implementing this.</term>
      <term full="Registration Authority" abbr="RA">An optional component of public key infrastructure to which a CA can delegate certain management functions.</term>
      <term full="Subject Alternative Name" abbr="SAN">A certificate extension that allows identities to be bound to the subject of a digital certificate.</term>
      <term full="Subject Key Identifier">A certificate extension that provides a means of identifying certificates that contain a particular public key.</term>
      <term full="Certificate Management over CMS" abbr="CMC"/>
      <term full="Cryptographic Message Syntax" abbr="CMS"/>
      <term full="Evaluation Activity" abbr="EA"/>
      <term full="Elliptic Curve" abbr="EC"/>
      <term full="Hypertext Transfer Protocol" abbr="HTTP"/>
      <term full="Hypertext Transfer Protocol Secure" abbr="HTTPS"/>
      <term full="International Telecommunication Union Telecommunication Standardization Sector" abbr="ITU-T"/>
      <term full="Operating System" abbr="OS"/>
      <term full="Random Bit Generator" abbr="RBG"/>
      <term full="Request for Comment" abbr="RFC"/>
      <term full="Transport Layer Security" abbr="TLS"/>
    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      The Target of Evaluation (TOE) in this functional package (FP) is a product that uses X.509 capabilities for certificates. A certificate user that depends on the public key of a certificate is required to process certificates using the ‘verify’ capabilities included in this FP. Such certificate users verify certificates for a variety of TOE functions, including subject authentication, trusted communications, validation of TOE software and firmware updates, or integrity verification as part of self testing. A certificate user that is represented as the subject of a certificate depends on the ‘assert’ capabilities included in this FP. TOE functions use certificates issued by a certification authority trusted by a relying party to convey a subject and context information associated with the certificate to the relying party. TOE functions that use certificates include external entity initiated communications with the TOE such as web services or email, and TOE-initiated communications with entities requiring client authentication. When all verifiers of a certificate are associated with TOE functions, it is permissible to use an embedded certification authority that is only trusted by the TOE (i.e., only locally trusted). When such functionality is provided, the TOE depends on the provider functionality of the FP. TOE functions that verify TOE provided certificates depend on the certificate status provider functionality in this FP; TOE functions that use TOE provided certificates depend on the certificate issuance functionality of this FP.
      <h:br/>
      <h:br/>
      A conformant TOE will include the ability to validate X.509 certificates presented to it, including:
      <h:ul>
        <h:li>cryptographic validity of the digital signature.</h:li>
        <h:li>time-based validity.</h:li>
        <h:li>issuer-based validity.</h:li>
        <h:li>revocation status using a Certificate Revocation List (CRL) or the Online Certificate Status Protocol (OCSP).</h:li>
        <h:li>validation that the certificate's extensions are consistent with its intended use.</h:li>
      </h:ul>
      A conformant TOE must also define its intended uses for X.509 certificates and how to proceed when a certificate with undetermined 
    		revocation status is presented to it.
      <h:br/>
      <h:br/>
      This FP also defines mechanisms by which the TSF can generate a Certificate Signing Request (CSR) for receiving a signed certificate from a 
    		Certification Authority (CA). This may be generated either as a file that is provided to a CA manually or done via an active network connection to the 
    		CA using Enrollment over Secure Transport (EST).
      <h:br/>
      <h:br/>
      There may also be some situations where revocation checking is not performed. This FP defines an optional requirement for cases where exceptions
    		to the claimed revocation functionality exist.
      <h:br/>
      <h:br/>
      Lastly, the X.509 functionality defined by this FP is part of a TOE, but is not considered to be an entire TOE on its own. X.509 functionality
    		is implemented by a wide variety of technology products, some of which are standalone and some dependent on a trusted platform
    		(such as a software application on a general-purpose computer or mobile device). Auditable events have been defined for the SFRs in this FP for cases
    		where the TOE boundary includes an audit function specified by FAU_GEN.1. A TOE that conforms to this FP may also implement or rely on its OE to implement
    		appropriate management functionality for X.509 functionality that may include:
      <h:ul>
        <h:li>specifying root and intermediate CA certificates to be used as trust anchors.</h:li>
        <h:li>generating certificate requests and loading signed certificates for the TOE's own use into its trust store.</h:li>
        <h:li>specifying the revocation method that is used.</h:li>
        <h:li>configuring how the TOE behaves in the event that certificate revocation information is unavailable.</h:li>
      </h:ul>
      Any conformant TOE must consider the extent to which X.509 functionality must be managed, and ensure that appropriate management claims are made in 
    		the TOE's ST or that the TOE conforms to a PP that allows a trusted platform in its OE to implement them.
      <h:br/>
      <h:br/>
      This FP describes the extended security functionality of X.509 in terms of
      <xref g="CC"/>.
      <h:br/>
      <h:br/>
      The contents of this FP must be appropriately incorporated into a PP, cPP, or PP-Module. When this FP 
    		is incorporated as such, the ST must include selection-based requirements in accordance with the selections or assignments 
    		indicated in the incorporating document.
      <h:br/>
      <h:br/>
      The PP, cPP, or PP-Module that instantiates this FP must typically include the following components in order to satisfy 
    		dependencies of this FP. It is the responsibility of the PP, cPP, or PP-Module author who incorporates this FP to 
    		ensure that dependence on these components is satisfied, either by the TOE or by assumptions about its OE.
      <h:br/>
      <h:br/>
      An ST must identify in its conformance claims the applicable version of the PP, cPP, or PP-Module, and of this
    		FP.
      <h:br/>
      <h:br/>
      <componentsneeded>
        <componentneeded>
          <componentid>FCS_CKM.1</componentid>
          <notes>To support public and private key pair generation for creating an X.509 CSR, the PP or PP-Module must include FCS_CKM.1 and specify the corresponding algorithms.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FCS_COP.1</componentid>
          <notes>To support the cryptography needed for X.509 validation, the PP or PP-Module must include FCS_COP.1 (iterating as needed) to specify appropriate digital signature validation and hash algorithms for the X.509 certificates presented to the TOE.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FCS_HTTPS_EXT.1</componentid>
          <notes>To support EST when claimed, or when CMC using HTTPS is claimed, the PP or PP-Module must include an SFR for HTTPS communications. Note that support for EST is not mandatory.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FCS_RBG.1</componentid>
          <notes>To support the Random Bit Generation (RBG) needed for public and private key pair generation, the PP or PP-Module must include FCS_RBG.1 or an extended SFR that defines comparable functionality.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FCS_TLSC_EXT.1</componentid>
          <notes>To support EST when claimed, the PP or PP-Module must include an SFR for TLS client communications. Note that support for EST is not mandatory.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FPT_KST_EXT.1</componentid>
          <notes>To support CA signing keys, whether the CA is using a certificate or the corresponding public key is loaded into the relying party’s trust store, the PP or PP-Module must include FPT_KST_EXT.1 to protect the private keys used.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FPT_KST_EXT.2</componentid>
          <notes>To support CA signing keys, whether the CA is using a certificate or the corresponding public key is loaded into the relying party’s trust store, the PP or PP-Module must include FPT_KST_EXT.2 to protect the private keys used.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FPT_STM.1</componentid>
          <notes>To support validating whether a presented X.509 certificate is expired, the PP or PP-Module must include FPT_STM.1 or some other requirement that ensures reliable system time.</notes>
        </componentneeded>
        <componentneeded>
          <componentid>FTP_ITC.1</componentid>
          <notes>To support EST when claimed, the PP or PP-Module must include FTP_ITC.1 to define a trusted channel between the TOE and a trusted CA. Note that support for EST is not mandatory.</notes>
        </componentneeded>
      </componentsneeded>
    </sec:Compliant_Targets_of_Evaluation>
    <sec:Use_Cases>
      The following use cases are distinct and may be combined for any given TOE. They include
      <h:ul>
        <h:li>the TOE as a relying party verifying the identity of entities using certificates 
				obtained from an external CA</h:li>
        <h:li>the TOE asserting an identity in a certificate provided by an external CA and
				providing identity verification (authentication) to external relying parties</h:li>
        <h:li>the TOE acting as the sole relying party of entities issued certificates using an 
				embedded CA</h:li>
      </h:ul>
      Combining the verify and subject use cases also includes authentication and verification 
		between internal entities. Combining all three use cases allows external CAs to be used for
		both internal and external entities, but an internal embedded CA is only to be used for
		internal relying parties.
      <h:br/>
      <h:br/>
      Note: A TOE that provides general Certification Authority functionality for external entities 
		should be validated against the Certification Authority Protection Profile instead of
		this FP.
      <h:br/>
      <h:br/>
      Note: TOEs that provide certification authority functionality as an embedded CA in support 
		of TLS inspection should use the SSL/TLS Inspection Proxy (STIP) Protection Profile module
		instead of this FP. The ‘provide’ functionality in this FP is a generalization of the security 
		requirements of the embedded CA functionality for STIP PP module, but this FP does not include
		the proxy and TLS processing requirements from the STIP PP module.
      <h:br/>
      <h:br/>
      The following diagrams show each TOE use case (within the red box) with respect to its role 
		in an overall system.
      <usecases>
        <usecase title="TOE as a Relying Party" id="usecase1">
          <description>
            <figure entity="images/usecase1.png" title="Use Case 1: TOE as a Relying Party" id="fig-usecase1"/>
          </description>
        </usecase>
        <usecase title="TOE Asserting an Identity Using Certificates" id="usecase2">
          <description>
            <figure entity="images/usecase2.png" title="Use Case 2: TOE Asserting an Identity Using Certificates" id="fig-usecase2"/>
          </description>
        </usecase>
        <usecase title="TOE as the Sole Relying Party of a Certificate Issued by an Embedded CA" id="usecase3">
          <description>
            <figure entity="images/usecase3.png" title="Use Case 3: TOE as the Sole Relying Party of a Certificate Issued by an Embedded CA" id="fig-usecase3"/>
          </description>
        </usecase>
      </usecases>
    </sec:Use_Cases>
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale" cc-errata="v1.1">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>conformant</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with/>
      <cc-pkg-claim/>
    </CClaimsInfo>
  </sec:Conformance_Claims>
  <!-- 3.0 Security Problem Definition-->
  <!-- 4.0 Security Objectives -->
  <!-- 5.0 Security Requirements -->
  <sec:Security_Functional_Requirements>
    <sec:ss-audit-table title="Auditable Events for Mandatory SFRs">
      <h:p>The auditable events specified in this FP are included in an ST 
			if the incorporating PP, cPP, or PP-Module supports audit event reporting through FAU_GEN.1,
			and if all other criteria in the incorporating PP or PP-Module are met.</h:p>
      <audit-table id="at-man-audit" table="mandatory">
        <h:div class="table-caption">
          <ctr ctr-type="Table" id="atref-mandatory">: Auditable Events for Mandatory SFRs</ctr>
        </h:div>
      </audit-table>
    </sec:ss-audit-table>
    <!-- 5.1.1 User Data Protection (FDP) -->
    <section id="fdp" title="User Data Protection (FDP)">
      <ext-comp-def title="Certificate Generation and Issuance" fam-id="FDP_CER_EXT">
        <fam-behavior>Components in this family define requirements for the TOE’s ability to generate and issue certificates.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Revocation List Generation" fam-id="FDP_CRL_EXT">
        <fam-behavior>Components in this family define requirements for the usage of certificate revocation lists (CRLs) as a method of recording certificate status information.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Status Information Required" fam-id="FDP_CSIR_EXT">
        <fam-behavior>Components in this family define requirements for the association of certificate status information with certificates issued by the TOE.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Status Information Generation" fam-id="FDP_CSI_EXT">
        <fam-behavior>Components in this family define requirements for the TOE’s ability to generate certificate status information and to modify the status of issued certificates.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="OCSP Basic Response Generation" fam-id="FDP_OCSP_EXT">
        <fam-behavior>Components in this family define requirements for the usage of the Online Certificate Status Protocol (OCSP) as a method of recording certificate status information.</fam-behavior>
      </ext-comp-def>
    </section>
    <!-- 5.1.2 Identification and Authentication (FIA) -->
    <section id="fia" title="Identification and Authentication (FIA)">
      <ext-comp-def title="CMC Client Certificate Enrollment" fam-id="FIA_CMCC_EXT">
        <fam-behavior>Components in this family define requirements for the TOE to generate CMC requests.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Management over CMS (CMC) Server" fam-id="FIA_CMCS_EXT">
        <fam-behavior>Components in this family define requirements for the TOE to accept CMC requests.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="CMP Certificate Enrollment" fam-id="FIA_CMPC_EXT">
        <fam-behavior>Components in this family define requirements for the TOE to generate CMP requests.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Management Protocol (CMP) Server" fam-id="FIA_CMPS_EXT">
        <fam-behavior>Components in this family define requirements for the TOE to authenticate CMP requests.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="EST Certificate Enrollment" fam-id="FIA_ESTC_EXT">
        <fam-behavior>Components in this family define requirements for the TOE’s use of Enrollment over Secure Transport (EST) to obtain certificates from an external CA.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Enrollment over Secure Transport (EST) Server" fam-id="FIA_ESTS_EXT">
        <fam-behavior>Components in this family define requirements for the TOE’s use of Enrollment over Secure Transport (EST) to authenticate certificates from an external CA.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Trust Store Management" fam-id="FIA_TSM_EXT">
        <fam-behavior>Components in this family define requirements for the TOE on how to manage trust stores.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="X.509 Certificate Handling" fam-id="FIA_X509_EXT">
        <fam-behavior>Components in this family define the behavior and use of X.509 certificates for functions to be performed by the TSF. Components in this family require validation of certificates according to a specified set of rules, use of certificates for authentication for protocols and integrity verification, generation of certificate requests, certificate enrollment, and revocation checking behavior.</fam-behavior>
      </ext-comp-def>
      <ext-comp-def title="Certificate Usage" fam-id="FIA_XCU_EXT">
        <fam-behavior>Components in this family define how the TSF handles X.509 certificates for specific functions for specific protocols.</fam-behavior>
      </ext-comp-def>
    </section>
  </sec:Security_Functional_Requirements>
  <bibliography>
    <entry id="bibRFC2986">
      <tag>RFC 2986</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc2986">PKCS #10: Certification Request Syntax Specification
					Version 1.7</h:a>
      </description>
    </entry>
    <entry id="bibRFC5280 ">
      <tag>RFC 5280</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate
					and Certificate Revocation List (CRL) Profile</h:a>
      </description>
    </entry>
    <entry id="bibRFC6066">
      <tag>RFC 6066</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension
					Definitions</h:a>
      </description>
    </entry>
    <entry id="bibRFC6960">
      <tag>RFC 6960</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc6960">X.509 Internet Public Key Infrastructure Online Certificate
					Status Protocol – OCSP</h:a>
      </description>
    </entry>
    <entry id="bibRFC6961">
      <tag>RFC 6961</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc6961">The Transport Layer Security (TLS) Multiple Certificate Status
					Request Extension</h:a>
      </description>
    </entry>
    <entry id="bibRFC7030">
      <tag>RFC 7030</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc7030">Enrollment over Secure Transport</h:a>
      </description>
    </entry>
    <entry id="bibRFC8603">
      <tag>RFC 8603</tag>
      <description>
        <h:a href="https://datatracker.ietf.org/doc/html/rfc8603">Commercial National Security Algorithm (CNSA) Suite Certificate
					and Certificate Revocation List (CRL) Profile</h:a>
      </description>
    </entry>
  </bibliography>
</Package>
